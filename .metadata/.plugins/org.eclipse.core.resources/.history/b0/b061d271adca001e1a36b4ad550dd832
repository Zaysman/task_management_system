/*
 * The purpose of this utility class is to handle 
 */

package com.isaiah.utilities;

import com.isaiah.objects.*;


import java.sql.*;
import java.util.LinkedList;
import java.util.List;



public class QueryUtility {


	
	public static void createUserinDB(User user) {

		try(Connection conn = DatabaseUtility.getTaskManagementConnection()) {
			
			Statement st = conn.createStatement();
			
			
		} catch(SQLException sqle) {
			System.err.println("An issue has occurred adding a user to the DB:" + sqle.getMessage());
			System.err.println("Printing Stack Trace\n" );
			sqle.printStackTrace();
		}
		
	}
	
	
	public static LinkedList<User> getAllUsers() {
		LinkedList<User> users = new LinkedList<>();

		try(Connection conn = DatabaseUtility.getTaskManagementConnection()) {

			Statement st =  conn.createStatement();
			ResultSet rs = st.executeQuery("select * from user_login;");
			int numCols = rs.getMetaData().getColumnCount();

			while(rs.next()) {
				User user = new User();
				user.setId(rs.getInt(1));
				user.setUsername(rs.getString(2));
				user.setPassword(rs.getString(3));
				users.add(user);
			}


		} catch (SQLException sqle) {
			System.err.println("An issue has occured with retrieving all users from the DB:" + sqle.getMessage());
			System.err.println("Printing Stack Trace\n" );
			sqle.printStackTrace();
		}



		return users;
	}

	public static User getUserById(int id) {
		User user = new User();

		try(Connection conn = DatabaseUtility.getTaskManagementConnection()) {
			Statement st = conn.createStatement();
			ResultSet rs = st.executeQuery("select * from user_login where user_id= " + id);

			while(rs.next()) {
				user.setId(rs.getInt(1));
				user.setUsername(rs.getString(2));
				user.setPassword(rs.getString(3));
			}


		} catch (SQLException sqle) {
			System.err.println("An issue has occured with retrieving user by id from the DB: " + sqle.getMessage());
			System.err.println("Printing Stack Trace" );
			sqle.printStackTrace();
		}



		return user;
	}
	
	public static User getUserByUserName(String username) {
		User user = new User();
		
		try(Connection conn = DatabaseUtility.getTaskManagementConnection()) {
			Statement st = conn.createStatement();
			ResultSet rs = st.executeQuery("select * from user_login where username= " + username);

			while(rs.next()) {
				user.setId(rs.getInt(1));
				user.setUsername(rs.getString(2));
				user.setPassword(rs.getString(3));
			}


		} catch (SQLException sqle) {
			System.err.println("An issue has occured with retrieving user by username from the DB: " + sqle.getMessage());
			System.err.println("Printing Stack Trace" );
			sqle.printStackTrace();
		}
		
		
		return user;
	}



}
